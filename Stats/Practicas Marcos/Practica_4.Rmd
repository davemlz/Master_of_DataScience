---
title: "Práctica 4"
output:
  html_document:
    df_print: paged
---

## David Montero Loaiza

### Problema 1

Simula los siguientes experimentos aleatorios usando la función runif:

#### i) Extraemos una carta al azar de una baraja española y vemos si es un basto o no.

```{r}
# PROBABILIDAD DE SACAR UN BASTO
prob_basto = 1/4

# UN SOLO INTENTO
n = 1

# SACAREMOS UN BASTO?
basto = runif(1) <= prob_basto
paste("Sacaremos un basto?",basto)
```

#### ii) Repetimos n veces el experimento del apartado anterior y anotamos el número de bastos.

```{r}
# n REPETICIONES
n = 1000000

# NUMERO DE BASTOS
num_bastos = sum(runif(n) <= prob_basto)
paste("Hemos sacado",num_bastos,"de",n,"intentos")
paste((num_bastos/n)*100,"% del total de intentos")
```

### Problema 2

El número de kilómetros recorridos, X, hasta que se produce una caída en una determinada carrera ciclista se puede modelizar con una distribución exponencial con función densidad $f(x) = \lambda e^{-\lambda x}$. Siendo $\lambda = 0.01$ el número medio de caídas por kilómetro.

Al ser positivas las distancias, se integra f(x) desde x = 0 hasta x:

$$\int_{0}^{x} \lambda e^{-\lambda x} dx = 1 - e^{-\lambda x}$$

Teniendo en cuenta que $\lambda = 0.01$, la inversa de la función anterior sería:

$$-100 log(1 - u)$$

Y finalmente podríamos realizar las simulaciones con el método de la función de distribución inversa:

#### i) Simula 1000 distancias entre caídas.

```{r}
# NUMERO DE DISTANCIAS A SIMULAR
n = 1000

# SIMULACION
x = -100*log(1 - runif(n))
```

#### ii) Compara gráficamente los números aleatorios con la distribución teórica.

```{r}
# HISTOGRAMA DE SIMULACIONES
hist(x,breaks = 30,freq = FALSE,main = "Histograma para n = 1000",xlab = "Kilometros recorridos")

# LAMBDA
lambda = 0.01

# FUNCION DE DISTRIBUCION TEORICA
curve(lambda*exp(-lambda*x),add = TRUE,col = 2)
```

### Problema 3

El tamaño angular en grados, X, de unos determinados objetos en el cielo es una variable aleatoria X con función densidad $f(x) = Kx^{-3}$ siendo x > 1 por razones físicas.

#### i) Halla el valor de la constante K.

Se integra f(x) desde x = 1 hasta infinito:

$$\int_{1}^{\infty} Kx^{-3} dx = K/2$$

Teniendo en cuenta que:

$$\int_{-\infty}^{\infty} Kx^{-3} dx = 1$$

Entonces:

$$K/2 = 1$$

Por lo tanto:

$$K = 2$$

#### ii) Genera 1000 números aleatorios siguiendo la distribución de X.

Al ser positivas las distancias, se integra f(x) desde x = 1 hasta x:

$$\int_{1}^{x} Kx^{-3} dx = K (\frac{1}{2}-\frac{1}{2 x^2})$$

Teniendo en cuenta que $K = 2$, la inversa de la función anterior sería:

$$\frac{1}{\sqrt{1-u}}$$

Y finalmente podríamos realizar las simulaciones con el método de la función de distribución inversa:

```{r}
# NUMERO DE DISTANCIAS A SIMULAR
n = 1000

# SIMULACION
x = 1/sqrt(1 - runif(n))
```

#### iii) Compara gráficamente los números aleatorios con la distribución teórica.

```{r}
# HISTOGRAMA DE SIMULACIONES
hist(x,breaks = 50,freq = FALSE,main = "Histograma para n = 1000",xlab = "Tamano angular en grados")

# K
K = 2

# FUNCION DE DISTRIBUCION TEORICA
curve(K*x^(-3),add = TRUE,col = 2)
```

