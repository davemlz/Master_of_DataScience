---
title: "Prácticas Estadística"
output:
  html_document:
    df_print: paged
---

# David Montero Loaiza {.tabset}

## Práctica 1

### Problema 1

Considera los datos de la liga NBA de baloncesto profesional de la temporada 2014-2015 que figuran en el archivo players stats.csv.

```{r}
path = "C:/Users/Dave Mont/Desktop/Practicas Marcos/players_stats.csv"
df = read.csv(path,sep = ",",header = TRUE,dec = ".",fill = TRUE)
```

#### i) Representa gráficamente las datos de la columna Height de forma que se aprecie la distribución de los datos.

```{r}
# HISTOGRAMA DE LOS DATOS DE ALTURA
hist(df$Height,breaks = 20,xlab = "Height",main = "Height Histogram")
```

#### ii) Calcula la media muestral y represéntala mediante una línea en la gráfica.

```{r}
# MEDIA MUESTRAL
m = mean(df$Height,na.rm = TRUE)
paste("La media de altura es",m)

# HISTOGRAMA DE LOS DATOS DE ALTURA
hist(df$Height,breaks = 20,xlab = "Height",main = "Height Histogram")
abline(v = m,col = "red")
```

#### iii) Calcula la desviación típica muestral y representa el intervalo media muestral $\pm$ desviación típica muestral en la gráfica.

```{r}
# DESVIACION ESTANDAR
desvest = sd(df$Height,na.rm = TRUE)
paste("La desviación estándar de la altura es",desvest)

# HISTOGRAMA DE LOS DATOS DE ALTURA
hist(df$Height,breaks = 20,xlab = "Height",main = "Height Histogram")
abline(v = m,col = "red")
abline(v = m + desvest,col = "blue",lty = 2)
abline(v = m - desvest,col = "blue",lty = 2)
```

#### iv) Comenta brevemente la gráfica.

El promedio de alturas ronda los 200 cm y estas tienen una desviación típica de aproximadamente 9 cm. Los datos se concentran mayormente entre $\pm$ desviaciones estándar, aunque haya una frecuencia alta de alturas por encima de los 200 cm.

### Problema 2

Descarga los datos de extensión de hielo ártico del directorio: ftp://sidads.colorado.edu/DATASETS/NOAA/G02135/north/daily/data/

#### i) Carga los datos en R. Recomendación: Elimina la segunda línea del archivo.

```{r}
# CARGAR DATOS
path = "C:/Users/Dave Mont/Desktop/Practicas Marcos/N_seaice_extent_daily_v3.0.csv"
df = read.csv(path,sep = ",",header = TRUE,dec = ".",fill = TRUE)
df = df[-1,]

# CONVERTIR DATOS A NUMERICOS
for(i in 1:5){
  df[,i] = as.numeric(as.vector(df[,i]))
}
```

#### ii) Averigua en qué meses suelen ser las extensiones máximas y mínimas.

```{r}
# FUNCION PARA OBTENER MESES CON EXTENSIONES MAXIMAS Y MINIMAS (U OTRA ESTADISTICA)
get_stat_month = function(df,stat){
  
  stat_year = tapply(df$Extent,df$Year,stat)
  years = unique(df$Year)
  stat_month_year = NULL
  
  for(i in 1:length(years)){
    year_df = df[df$Year == years[i],]
    year_stat_month = tapply(year_df$Extent,year_df$Month,stat)
    stat_month_year[i] = which(year_stat_month == stat_year[i])
  }
  
  stat_df = data.frame(years,stat_month_year)
  
  return(stat_df)
  
}

# MESES CON EXTENSIONES MAXIMAS
max_months = get_stat_month(df,max)
max_months

# MESES CON EXTENSIONES MÍNIMAS
min_months = get_stat_month(df,min)
min_months
```

#### iii) Representa gráficamente los datos de extensión medianos de cada mes.

```{r}
# EXTENSION MEDIANA DE CADA MES
median_month = tapply(df$Extent,df$Month,median)

# GRAFICO DE EXTENSION MEDIANA
plot(1:12,median_month,type = "l",main = "Extensión mediana de cada mes",xlab = "Mes",ylab = "Extensión")
```

#### iv) Añade una región sombreada correspondiente a los percentiles del 5% y 95% de cada mes.

```{r}
# EXTENSION MEDIA DE CADA MES
mean_month = tapply(df$Extent,df$Month,mean)

# PERCENTILES DEL 5% Y DEL 95%
q0.05_month = tapply(df$Extent,df$Month,quantile,probs = 0.05)
q0.95_month = tapply(df$Extent,df$Month,quantile,probs = 0.95)

x = 1:12

# GRAFICO DE EXTENSION MEDIANA
plot(1:12,median_month,ylim = c(0,20),type = "l",main = "Extensión mediana de cada mes",xlab = "Mes",ylab = "Extensión")
polygon(c(x, rev(x)), c(q0.95_month, rev(q0.05_month)), col = "grey80", border = NA)
lines(x,median_month,col = "red")
```

#### v) Añaade una línea correspondiente a los datos de 2019 y otra para los datos de 2012.

```{r}
# DATOS MEDIANOS DEL 2012 Y 2019
df_2012 = df[df$Year == 2012,]
df_2019 = df[df$Year == 2019,]

month_2012 = tapply(df_2012$Extent,df_2012$Month,median)
month_2019 = tapply(df_2019$Extent,df_2019$Month,median)

# GRAFICO DE EXTENSION MEDIANA
plot(1:12,median_month,ylim = c(0,20),type = "l",main = "Extensión mediana",xlab = "Mes",ylab = "Extensión")
polygon(c(x, rev(x)), c(q0.95_month, rev(q0.05_month)), col = "grey80", border = NA)
lines(x,median_month,col = "red")
lines(x,month_2012,col = "green")
lines(1:10,month_2019,col = "blue")
legend("bottomleft",lty=1,col = c("red","green","blue"),c("Mediana","2012","2019"))
```

#### vi) Comenta brevemente la gráfica.

Entre los 6 y los 12 meses los datos se dispersan un poco más que en el resto de meses. En comparación con la mediana, los valores medianos del 2012 y 2019 de extensión son menores en el segundo semestre del año. Los datos del 2019 muestran que la extensión es menor que la mediana durante todo el tiempo.

## Práctica 2

### Problema 1

Considera un examen de 10 preguntas con 5 posibles respuestas para cada pregunta en el que se responde al azar. Considera la variable aleatoria X = número de preguntas acertadas en el examen.

```{r}
n = 10
p = 1/5
x = 0:10
```


#### i) ¿Cuánto valen E(X) y SD(X)?

```{r}
# ESPERANZA E(X)
E = n*p

# DESVIACION ESTANDAR SD(X)
V = n*p*(1-p)
SD = sqrt(V)

paste("E(X) =",E,"y SD(X) =",SD)
```

#### ii) Calcula la probabilidad de acertar 0, 1, 2, ..., 10 preguntas. ¿Cuánto vale la suma de las once probabilidades que acabas de calcular?

```{r}
# PROBABILIDAD DE ACERTAR DE 0 A 10 PREGUNTAS
ps = dbinom(x,n,p)
for(i in x){print(paste("Probabilidad de acertar",i,"=",ps[i+1]))} 

# SUMA DE PROBABILIDADES
p_sum = sum(ps)
paste("Suma de probabilidades =",p_sum)
```

#### iii) Calcula las probabilidades acumuladas, es decir la probabilidad de obtener 0 aciertos o menos, 1 acierto o menos, 2 aciertos o menos ... 10 aciertos o menos.

```{r}
# PROBABILIDADES ACUMULADAS
pa = pbinom(x,n,p)
for(i in x){print(paste("Probabilidad de acertar",i," o menos =",pa[i+1]))} 
```

#### iv) Representa las probabilidades de los apartados anteriores en una gráfica con dos paneles. Guarda la figura en un archivo. ¿Cuál es el número de aciertos más probable?

```{r}
# BARPLOTS PARA LAS PROBABILIDADES Y PROBABILIDADES ACUMULADAS
par(mfrow=c(1,2))

barplot(ps,names.arg = 0:10,main = "Probabilidades")
barplot(pa,names.arg = 0:10,main = "Probabilidades Acumuladas")
```

El número de aciertos más probable es de 2 aciertos.

### Problema 2

En el archivo GOT.csv figura el número de muertes por cada uno de los 67 primeros capítulos de la serie Juego de Tronos.

```{r}
GOT = read.csv("C:/Users/Dave Mont/Desktop/Practicas Marcos/GOT.csv")
```

#### i) Razona qué distribución usarías para calcular probabilidades asociadas a esta variable. Representa gráficamente los datos correspondientes al número de muertes de forma que te ayude a decidir qué distribución usar.

```{r}
# HISTOGRAMA DEL NUMERO DE MUERTES
hist(GOT$NumDeaths,breaks = max(GOT$NumDeaths),main = "Histograma",xlab = "Número de muertes por episodio")
```

Teniendo en cuenta el histograma, la distribución de Poison es la más adecuada.

#### ii) Estima la probabilidad de que en el siguiente capítulo haya más de 4 muertes. Explica qué suposiciones has hecho. ¿Podría fallar alguna de las suposiciones?

```{r}
# LAMBDA
lambda = mean(GOT$NumDeaths)

# 4 MUERTES
x = 4

# PROBABILIDAD DE QUE HAYAN MAS DE 4 MUERTES
r = 1 - ppois(x,lambda)
paste("La probabilidad de que hayan más de 4 muertes en el siguiente capítulo es de:",r)
```

#### iii) Calcula la probabilidad de que en el siguiente capítulo haya exactamente 0, 1, 2, ..., 10 muertes. Representa las probabilidades en una gráfica. ¿Cuál es el número de muertes más probable? ¿Cuánto vale la suma de las once probabilidades? ¿Por qué?

```{r}
# PROBABILIDAD DE QUE HAYAN DE DE 0 A 10 MUERTES
ps = dpois(0:10,lambda)
barplot(ps,names.arg = 0:10,main = "Probabilidad de muertes en el siguiente capítulo",xlab = "Número de muertes")

# SUMA DE PROBABILIDADES
prob_sum = sum(ps)
paste("La suma de probabilidades es:",prob_sum)
```

El número de muertes más probable es de 3 muertes. La suma de probabilidades se va a acercar a 1 pero nunca será igual, pues pueden haber un número muy elevado de muertes, aunque la probabilidad de que esto ocurra sea baja.

#### iv) ¿Cuánto valen E(X) y SD(X)? Explica su significado en este contexto.

```{r}
# ESPERANZA
E = lambda
paste("E(X) =",E)

# DESVIACION ESTANDAR
V = lambda
SD = sqrt(V)
paste("SD(X) =",SD)
```

El valor esperado de muertes por capítulo es el promedio del número de muertes hasta ahora, mientras que la desviación estándar sería la raíz cuadrada de la media. Por lo tanto, es más probable que durante un capítulo ocurran 3 muertes, seguido de aproximadamente 2 muertes menos o 2 muertes más.

### Problema 3

colesterol se mide en una población con media 180 mg/dL y desviacón típica 25 mg/dL.

```{r}
mu = 180
sigma = 25
```

#### i) Calcula la probabilidad de que una persona tenga más de 225 mg/dL de colesterol en sangre.

```{r}
# 225 mg/dL
x = 225

# PROBABILIDAD DE QUE UNA PERSONA TENGA MAS DE 225 mg/dL
p = 1 - pnorm(x,mu,sigma)
paste("La probabilidad de que una persona tenga más de 225 mg/dL es de",p)
```

#### ii) Calcula el percentil del 95% de colesterol en sangre en dicha población.

```{r}
# PRECENTIL DEL 95%
q = 0.95

# PECENTIL DEL 95% DE COLESTEROL EN SANGRE
pq = qnorm(q,mu,sigma)
paste("El percentil del 95% de colesterol en sangre es",pq)
```

#### iii) Representa la función de densidad y la función de distribución en una gráfica con dos paneles. Guarda la figura en un archivo.

```{r}
# GRAFICAS DE FUNCION DE DENSIDAD Y DE DISTRIBUCION
par(mfrow=c(1,2))

xlabel = "Colesterol en sangre (mg/dL)"
ylabel = "Probabilidad"

low = mu - 3*sigma
hig = mu + 3*sigma

curve(dnorm(x,mu,sigma),low,hig,col = 2,main = "Función de densidad",xlab = xlabel,ylab = ylabel)
curve(pnorm(x,mu,sigma),low,hig,col = 4,main = "Función de distribución",xlab = xlabel,ylab = ylabel)
```

#### iv) ¿Cuánto valen E(X) y SD(X)?

```{r}
# ESPERANZA
E = mu
paste("E(X) =",E)

# DESVIACION ESTANDAR
SD = sigma
paste("SD(X) =",SD)
```

## Práctica 3

### Problema 1

Estamos esperando un tren que llegaría en los próximos 100 minutos pero desconocemos el momento exacto.

Definimos la variable aleatoria X = "tiempo de espera en minutos". Realiza las siguientes tareas:

#### i) Considera que X es una variable aleatoria uniforme en el intervalo [0; 100]. ¿Cuánto vale E(X) y Var(X)?

```{r}
a = 0
b = 100

# VALOR ESPERADO
E = (b + a)/2
paste("Valor esperado E(X) =",E)

# VARIANZA
V = ((b - a)^2)/12
paste("Varianza Var(X) =",V)
```

#### ii) Simula los tiempos de espera de una muestra aleatoria de personas con tamaño muestral n = 30 y calcula la media muestral X y la varianza muestral S^2.

```{r}
# TAMANO MUESTRAL
n = 30

# TIEMPOS DE ESPERA SIMULADOS
d = runif(n,a,b)

# MEDIA MUESTRAL
X = mean(d)
paste("Media muestral =",X)

# VARIANZA MUESTRAL
V = var(d)/n
paste("Varianza muestral =",V)
```

#### iii) ¿Cuánto valen E(X) y Var(X) para n = 30? Y si aumentaramos a n = 100?

```{r}
# VALOR ESPERADO PARA n = 30 Y n = 100
E = (b + a)/2
paste("Valor esperado para n = 30 y n = 100 E(X) =",E)

# VARIANZA PARA n = 30
v30 = var(runif(30,a,b))/30
paste("Varianza para n = 30 V(X) =",v30)

# VARIANZA PARA n = 100
v100 = var(runif(100,a,b))/100
paste("Varianza para n = 100 V(X) =",v100)
```

#### iv) Simula 500 muestras aleatorias de tamaño n = 30 de la variable X.

```{r}
# MATRIZ DE 500 FILAS POR 30 COLUMNAS
M30 = matrix(runif(30*500,0,100),500,30)
```

#### v) Calcula las 500 medias muestrales.

```{r}
# 500 MEDIAS MUESTRALES
X30 = rowMeans(M30)
```

#### vi) Calcula la media y varianza de las 500 medias muestrales y comparalas con los valores obtenidos en el tercer apartado.

```{r}
# MEDIA DE LAS 500 MEDIAS MUESTRALES
x30 = mean(X30)
paste("Media =",x30)

# VARIANZA DE LAS 500 MEDIAS MUESTRALES
V30 = var(X30)
paste("Varianza =",V30)
```

#### vii) Repite los tres pasos anteriores para 500 muestras aleatorias de tamaño n = 100.

```{r}
# MATRIZ DE 500 FILAS POR 100 COLUMNAS
M100 = matrix(runif(100*500,0,100),500,100)

# MEDIAS MUESTRALES
X100 = rowMeans(M100)

# MEDIA DE LAS 500 MEDIAS MUESTRALES
x100 = mean(X100)
paste("Media =",x100)

# VARIANZA DE LAS 500 MEDIAS MUESTRALES
V100 = var(X100)
paste("Varianza =",V100)
```

#### viii) Representa las 500 medias de tamaño n = 30 y las 500 medias de tamaño n = 100 mediante dos histogramas en una gráfica de dos paneles.

```{r}
# NUMERO DE BINS PARA HISTOGRAMAS
bins = 30

# HISTOGRAMAS
par(mfrow=c(1,2)) 
hist(X30,breaks = bins,freq = FALSE,main = "Histograma para n = 30",xlab = "Tiempo de espera en min")
hist(X100,breaks = bins,freq = FALSE,main = "Histograma para n = 100",xlab = "Tiempo de espera en min")
```

#### ix) Superpón a cada histograma la función densidad normal con mu = E(X) y sigma^2 = Var(X)/n.

```{r}
# HISTOGRAMAS
par(mfrow=c(1,2))

# HISTOGRAMA Y FUNCION DE DENSIDAD NORMAL PARA n = 30
hist(X30,breaks = bins,freq = FALSE,main = "Histograma para n = 30",xlab = "Tiempo de espera en min")
curve(dnorm(x,E,sqrt(v30)),add = TRUE,col = 2)

# HISTOGRAMA Y FUNCION DE DENSIDAD NORMAL PARA n = 100
hist(X100,breaks = bins,freq = FALSE,main = "Histograma para n = 100",xlab = "Tiempo de espera en min")
curve(dnorm(x,E,sqrt(v100)),add = TRUE,col = 4)
```

#### x) Comenta el resultado.

Al realizar 500 muestras aleatorias de tamaño n = 100 la densidad aumenta en el valor esperado E(X) = 50 en relación con las 500 muestras aleatorias de tamaño n = 30. Al disminuir la varianza debido al aumento del tamaño de cada muestra la densidad se concentra más en la media.

## Práctica 4

### Problema 1

Simula los siguientes experimentos aleatorios usando la función runif:

#### i) Extraemos una carta al azar de una baraja española y vemos si es un basto o no.

```{r}
# PROBABILIDAD DE SACAR UN BASTO
prob_basto = 1/4

# UN SOLO INTENTO
n = 1

# SACAREMOS UN BASTO?
basto = runif(1) <= prob_basto
paste("Sacaremos un basto?",basto)
```

#### ii) Repetimos n veces el experimento del apartado anterior y anotamos el número de bastos.

```{r}
# n REPETICIONES
n = 1000000

# NUMERO DE BASTOS
num_bastos = sum(runif(n) <= prob_basto)
paste("Hemos sacado",num_bastos,"de",n,"intentos")
paste((num_bastos/n)*100,"% del total de intentos")
```

### Problema 2

El número de kilómetros recorridos, X, hasta que se produce una caída en una determinada carrera ciclista se puede modelizar con una distribución exponencial con función densidad $f(x) = \lambda e^{-\lambda x}$. Siendo $\lambda = 0.01$ el número medio de caídas por kilómetro.

Al ser positivas las distancias, se integra f(x) desde x = 0 hasta x:

$$\int_{0}^{x} \lambda e^{-\lambda x} dx = 1 - e^{-\lambda x}$$

Teniendo en cuenta que $\lambda = 0.01$, la inversa de la función anterior sería:

$$-100 log(1 - u)$$

Y finalmente podríamos realizar las simulaciones con el método de la función de distribución inversa:

#### i) Simula 1000 distancias entre caídas.

```{r}
# NUMERO DE DISTANCIAS A SIMULAR
n = 1000

# SIMULACION
x = -100*log(1 - runif(n))
```

#### ii) Compara gráficamente los números aleatorios con la distribución teórica.

```{r}
# HISTOGRAMA DE SIMULACIONES
hist(x,breaks = 30,freq = FALSE,main = "Histograma para n = 1000",xlab = "Kilometros recorridos")

# LAMBDA
lambda = 0.01

# FUNCION DE DISTRIBUCION TEORICA
curve(lambda*exp(-lambda*x),add = TRUE,col = 2)
```

### Problema 3

El tamaño angular en grados, X, de unos determinados objetos en el cielo es una variable aleatoria X con función densidad $f(x) = Kx^{-3}$ siendo x > 1 por razones físicas.

#### i) Halla el valor de la constante K.

Se integra f(x) desde x = 1 hasta infinito:

$$\int_{1}^{\infty} Kx^{-3} dx = K/2$$

Teniendo en cuenta que:

$$\int_{-\infty}^{\infty} Kx^{-3} dx = 1$$

Entonces:

$$K/2 = 1$$

Por lo tanto:

$$K = 2$$

#### ii) Genera 1000 números aleatorios siguiendo la distribución de X.

Al ser positivas las distancias, se integra f(x) desde x = 1 hasta x:

$$\int_{1}^{x} Kx^{-3} dx = K (\frac{1}{2}-\frac{1}{2 x^2})$$

Teniendo en cuenta que $K = 2$, la inversa de la función anterior sería:

$$\frac{1}{\sqrt{1-u}}$$

Y finalmente podríamos realizar las simulaciones con el método de la función de distribución inversa:

```{r}
# NUMERO DE DISTANCIAS A SIMULAR
n = 1000

# SIMULACION
x = 1/sqrt(1 - runif(n))
```

#### iii) Compara gráficamente los números aleatorios con la distribución teórica.

```{r}
# HISTOGRAMA DE SIMULACIONES
hist(x,breaks = 50,freq = FALSE,main = "Histograma para n = 1000",xlab = "Tamano angular en grados")

# K
K = 2

# FUNCION DE DISTRIBUCION TEORICA
curve(K*x^(-3),add = TRUE,col = 2)
```


## Práctica 5

### Problema 1

Realiza las siguientes tareas:

#### i) Simula 50 tiradas de un dado.

```{r}
n = 6

# 50 TIRADAS DE UN DADO
tir50 = sample(6,50,replace = TRUE)
print(tir50)
```

#### ii) Considera la variable aleatoria, X, definida como el número que sale al tirar el dado. ¿Cuánto valen $\bar{X}$, $S^2$, $E(\bar{X})$, $Var(\bar{X})$, $E(X)$ y $Var(X)$?

```{r}
# MEDIA MUESTRAL
X = mean(tir50)
paste("Media muestral:",X)

# VARIANZA MUESTRAL
S2 = var(tir50)
paste("Varianza muestral:",S2)

# VALOR ESPERADO DE LA VARIABLE ALEATORIA
E = (n + 1)/2
paste("Valor esperado de la variable aleatoria:",E)

# VARIANZA DE LA VARIABLE ALEATORIA
V = (n^2 - 1)/12
paste("Varianza de la variable aleatoria:",V)

# VALOR ESPERADO DE LA MEDIA MUESTRAL
Ex = E
paste("Valor esperado de la media muestral:",Ex)

# VARIANZA DE LA MEDIA MUESTRAL
Vx = V/n
paste("Varianza de la media muestral:",Vx)
```

### Problema 2

Realiza las siguientes tareas:

#### i) Simula 50 tiradas de dos dados.

```{r}
# 50 TIRADAS DE DOS DADOS
tir50_d1 = sample(6,50,replace = TRUE)
tir50_d2 = sample(6,50,replace = TRUE)
tir50_2dados = tir50_d1 + tir50_d2
print(tir50_2dados)
```

#### ii) Considera la variable aleatoria, X, definida como la suma de los números que salen al tirar dos dados. ¿Cuánto valen $\bar{X}$, $S^2$, $E(\bar{X})$, $Var(\bar{X})$, $E(X)$ y $Var(X)$?

```{r}
# MEDIA MUESTRAL
X = mean(tir50_2dados)
paste("Media muestral:",X)

# VARIANZA MUESTRAL
S2 = var(tir50_2dados)
paste("Varianza muestral:",S2)

# VALOR ESPERADO DE LA VARIABLE ALEATORIA
E = X
paste("Valor esperado de la variable aleatoria:",E)

# VARIANZA DE LA VARIABLE ALEATORIA
V = S2
paste("Varianza de la variable aleatoria:",V)

# VALOR ESPERADO DE LA MEDIA MUESTRAL
Ex = E
paste("Valor esperado de la media muestral:",Ex)

# VARIANZA DE LA MEDIA MUESTRAL
Vx = V/50
paste("Varianza de la media muestral:",Vx)
```

### Problema 3

Realiza las siguientes tareas:

#### i) Simula alturas de 50 personas de una población de altura media 176 y desviación típica 11 centímetros.

```{r}
# SIMULACION DE 50 ALTURAS
mu = 176
sigma = 11
alturas = rnorm(50,mu,sigma)
print(alturas)
```

#### ii) Considera la variable aleatoria, X, definida como la altura de una persona de la población descrita anteriormente. ¿Cuánto valen $\bar{X}$, $S^2$, $E(\bar{X})$, $Var(\bar{X})$, $E(X)$ y $Var(X)$?

```{r}
# MEDIA MUESTRAL
X = mean(alturas)
paste("Media muestral:",X)

# VARIANZA MUESTRAL
S2 = var(alturas)
paste("Varianza muestral:",S2)

# VALOR ESPERADO DE LA VARIABLE ALEATORIA
E = X
paste("Valor esperado de la variable aleatoria:",E)

# VARIANZA DE LA VARIABLE ALEATORIA
V = S2
paste("Varianza de la variable aleatoria:",V)

# VALOR ESPERADO DE LA MEDIA MUESTRAL
Ex = E
paste("Valor esperado de la media muestral:",Ex)

# VARIANZA DE LA MEDIA MUESTRAL
Vx = V/50
paste("Varianza de la media muestral:",Vx)
```

### Problema 4

Realiza las siguientes tareas:

#### i) Simula el número de goles marcados en 10 partidos siendo el promedio de goles por partido en la liga 2.8.

```{r}
# SIMULACION DEL NUMERO DE GOLES
lambda = 2.8
goles = rpois(10,lambda)
print(goles)
```

#### ii) Considera la variable aleatoria, X, definida como el número de goles en un partido de la liga anteriormente mencionada. ¿Cuánto valen $\bar{X}$, $S^2$, $E(\bar{X})$, $Var(\bar{X})$, $E(X)$ y $Var(X)$?

```{r}
# MEDIA MUESTRAL
X = mean(goles)
paste("Media muestral:",X)

# VARIANZA MUESTRAL
S2 = var(goles)
paste("Varianza muestral:",S2)

# VALOR ESPERADO DE LA VARIABLE ALEATORIA
E = lambda
paste("Valor esperado de la variable aleatoria:",E)

# VARIANZA DE LA VARIABLE ALEATORIA
V = lambda
paste("Varianza de la variable aleatoria:",V)

# VALOR ESPERADO DE LA MEDIA MUESTRAL
Ex = E
paste("Valor esperado de la media muestral:",Ex)

# VARIANZA DE LA MEDIA MUESTRAL
Vx = V/10
paste("Varianza de la media muestral:",Vx)
```

### Problema 5

Simula las posiciones de 32 fichas colocadas al azar en un tablero de 8 por 8 casillas, teniendo en cuenta que solo puede haber una ficha por casilla.

```{r}
# SIMULAR LAS POSICIONES DE 32 FICHAS
x = c(rep(1,32),rep(0,32))
tablero = matrix(sample(x,8*8),8,8)
print(tablero)
```

### Problema 6

Representa gráficamente cada una de las muestras simuladas y guarda las gráficas en archivo.

#### Simulación de 50 tiradas de un dado

```{r}
hist(tir50,main = "Histograma de 50 tiradas de un dado",xlab = "Valor del dado",freq = FALSE,breaks = 10)
```

#### Simulación de 50 tiradas de dos dados

```{r}
hist(tir50_2dados,main = "Histograma de 50 tiradas de dos dados",xlab = "Valor de la suma",freq = FALSE,breaks = 10)
```

#### Simulación de 50 alturas

```{r}
hist(alturas,main = "Histograma de 50 alturas",xlab = "Altura",freq = FALSE,breaks = 10)
```

#### Simulación del número de goles en 10 partidos

```{r}
hist(goles,main = "Histograma de goles en 10 partidos",xlab = "Goles por partido",freq = FALSE,breaks = 10)
```

#### Simulación de posiciones de 32 fichas en un tablero

```{r}
image(tablero)
```


## Práctica 6

### Problema 1

El tiempo de curación medio de un resfriado común es de 6.7 días. Un determinado producto homeopático pretende reducir el tiempo de curación del resfriado común. Se administra el medicamento a 20 personas y se anotan los tiempos de curación que figuran en el archivo days.txt.

```{r}
path = "C:/Users/Dave Mont/Desktop/Practicas Marcos/days.txt"
days = read.table(path)$V1
ref = 6.7
```

#### i) Representa los datos y el valor de referencia.

```{r}
hist(days,breaks = 10)
abline(v = ref,col = "red")
```

#### ii) Realiza un test de hipótesis para determinar si el producto es efectivo o no.

```{r}
# TEST DE HIPOTESIS
t.test(days,mu = ref,alternative = "less")
```

Como el valor-p > alfa = 0.05 no se rechaza la hipótesis nula y se determina que el producto puede no ser efectivo.

### Problema 2

Se quiere estudiar el efecto del consumo prolongado de cannabis sobre el cerebro humano (ver Yucel et al. 2008). Para ello se reclutaron 15 fumadores de más de 10 años de antiguedad con un consumo igual o superior a 5 porros por día. Para el grupo control, se seleccionaron 16 no fumadores de edad y educación similar. Los datos del volumen de los hipocampos izquierdo y derecho medido en milímetros cúbicos para ambos grupos, figuran respectivamente en los archivos con cannabis.txt y sin cannabis.txt.

```{r}
path_con = "C:/Users/Dave Mont/Desktop/Practicas Marcos/con_cannabis.txt"
path_sin = "C:/Users/Dave Mont/Desktop/Practicas Marcos/sin_cannabis.txt"

con_can = read.table(path_con,header = TRUE)
sin_can = read.table(path_sin,header = TRUE)
```

#### i) Representa gráficamente los datos.

```{r}
# BREAKS PARA HISTOGRAMAS
bins = 10

# HISTOGRAMAS
par(mfrow = c(2,2))
hist(con_can$izq,main = "Hipocampo izquierdo",ylab = "Con Cannabis",freq = FALSE,xlab = NULL,breaks = bins)
hist(con_can$der,main = "Hipocampo derecho",ylab = NULL,freq = FALSE,xlab = NULL,breaks = bins)
hist(sin_can$izq,main = NULL,ylab = "Sin Cannabis",freq = FALSE,xlab = "Volumen medio",breaks = bins)
hist(sin_can$der,main = NULL,ylab = NULL,freq = FALSE,xlab = "Volumen medio",breaks = bins)
```

#### ii) Realiza un test de hipótesis para determinar si el consumo prolongado de cannabis afecta al volumen del hipocampo.

```{r}
# TEST DE HIPOTESIS
t.test(con_can$izq + con_can$der,sin_can$izq + sin_can$der)
```

Como el valor-p < alfa = 0.05 el se rechaza la hipótesis nula y se determina que el consumo prolongado de cannabis afecta al volumen del hipocampo.