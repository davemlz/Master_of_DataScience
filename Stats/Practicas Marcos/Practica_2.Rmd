---
title: "Práctica 2"
output:
  html_document:
    df_print: paged
---

## David Montero Loaiza

### Problema 1

Considera un examen de 10 preguntas con 5 posibles respuestas para cada pregunta en el que se responde al azar. Considera la variable aleatoria X = número de preguntas acertadas en el examen.

```{r}
n = 10
p = 1/5
x = 0:10
```


#### i) ¿Cuánto valen E(X) y SD(X)?

```{r}
# ESPERANZA E(X)
E = n*p

# DESVIACION ESTANDAR SD(X)
V = n*p*(1-p)
SD = sqrt(V)

paste("E(X) =",E,"y SD(X) =",SD)
```

#### ii) Calcula la probabilidad de acertar 0, 1, 2, ..., 10 preguntas. ¿Cuánto vale la suma de las once probabilidades que acabas de calcular?

```{r}
# PROBABILIDAD DE ACERTAR DE 0 A 10 PREGUNTAS
ps = dbinom(x,n,p)
for(i in x){print(paste("Probabilidad de acertar",i,"=",ps[i+1]))} 

# SUMA DE PROBABILIDADES
p_sum = sum(ps)
paste("Suma de probabilidades =",p_sum)
```

#### iii) Calcula las probabilidades acumuladas, es decir la probabilidad de obtener 0 aciertos o menos, 1 acierto o menos, 2 aciertos o menos ... 10 aciertos o menos.

```{r}
# PROBABILIDADES ACUMULADAS
pa = pbinom(x,n,p)
for(i in x){print(paste("Probabilidad de acertar",i," o menos =",pa[i+1]))} 
```

#### iv) Representa las probabilidades de los apartados anteriores en una gráfica con dos paneles. Guarda la figura en un archivo. ¿Cuál es el número de aciertos más probable?

```{r}
# BARPLOTS PARA LAS PROBABILIDADES Y PROBABILIDADES ACUMULADAS
par(mfrow=c(1,2))

barplot(ps,names.arg = 0:10,main = "Probabilidades")
barplot(pa,names.arg = 0:10,main = "Probabilidades Acumuladas")
```

El número de aciertos más probable es de 2 aciertos.

### Problema 2

En el archivo GOT.csv figura el número de muertes por cada uno de los 67 primeros capítulos de la serie Juego de Tronos.

```{r}
GOT = read.csv("C:/Users/Dave Mont/Desktop/Estadistica/Práctica 2-20191023/GOT.csv")
```

#### i) Razona qué distribución usarías para calcular probabilidades asociadas a esta variable. Representa gráficamente los datos correspondientes al número de muertes de forma que te ayude a decidir qué distribución usar.

```{r}
# HISTOGRAMA DEL NUMERO DE MUERTES
hist(GOT$NumDeaths,breaks = max(GOT$NumDeaths),main = "Histograma",xlab = "Número de muertes por episodio")
```

Teniendo en cuenta el histograma, la distribución de Poison es la más adecuada.

#### ii) Estima la probabilidad de que en el siguiente capítulo haya más de 4 muertes. Explica qué suposiciones has hecho. ¿Podría fallar alguna de las suposiciones?

```{r}
# LAMBDA
lambda = mean(GOT$NumDeaths)

# 4 MUERTES
x = 4

# PROBABILIDAD DE QUE HAYAN MAS DE 4 MUERTES
r = 1 - ppois(x,lambda)
paste("La probabilidad de que hayan más de 4 muertes en el siguiente capítulo es de:",r)
```

#### iii) Calcula la probabilidad de que en el siguiente capítulo haya exactamente 0, 1, 2, ..., 10 muertes. Representa las probabilidades en una gráfica. ¿Cuál es el número de muertes más probable? ¿Cuánto vale la suma de las once probabilidades? ¿Por qué?

```{r}
# PROBABILIDAD DE QUE HAYAN DE DE 0 A 10 MUERTES
ps = dpois(0:10,lambda)
barplot(ps,names.arg = 0:10,main = "Probabilidad de muertes en el siguiente capítulo",xlab = "Número de muertes")

# SUMA DE PROBABILIDADES
prob_sum = sum(ps)
paste("La suma de probabilidades es:",prob_sum)
```

El número de muertes más probable es de 3 muertes. La suma de probabilidades se va a acercar a 1 pero nunca será igual, pues pueden haber un número muy elevado de muertes, aunque la probabilidad de que esto ocurra sea baja.

#### iv) ¿Cuánto valen E(X) y SD(X)? Explica su significado en este contexto.

```{r}
# ESPERANZA
E = lambda
paste("E(X) =",E)

# DESVIACION ESTANDAR
V = lambda
SD = sqrt(V)
paste("SD(X) =",SD)
```

El valor esperado de muertes por capítulo es el promedio del número de muertes hasta ahora, mientras que la desviación estándar sería la raíz cuadrada de la media. Por lo tanto, es más probable que durante un capítulo ocurran 3 muertes, seguido de aproximadamente 2 muertes menos o 2 muertes más.

### Problema 3

colesterol se mide en una población con media 180 mg/dL y desviacón típica 25 mg/dL.

```{r}
mu = 180
sigma = 25
```

#### i) Calcula la probabilidad de que una persona tenga más de 225 mg/dL de colesterol en sangre.

```{r}
# 225 mg/dL
x = 225

# PROBABILIDAD DE QUE UNA PERSONA TENGA MAS DE 225 mg/dL
p = 1 - pnorm(x,mu,sigma)
paste("La probabilidad de que una persona tenga más de 225 mg/dL es de",p)
```

#### ii) Calcula el percentil del 95% de colesterol en sangre en dicha población.

```{r}
# PRECENTIL DEL 95%
q = 0.95

# PECENTIL DEL 95% DE COLESTEROL EN SANGRE
pq = qnorm(q,mu,sigma)
paste("El percentil del 95% de colesterol en sangre es",pq)
```

#### iii) Representa la función de densidad y la función de distribución en una gráfica con dos paneles. Guarda la figura en un archivo.

```{r}
# GRAFICAS DE FUNCION DE DENSIDAD Y DE DISTRIBUCION
par(mfrow=c(1,2))

xlabel = "Colesterol en sangre (mg/dL)"
ylabel = "Probabilidad"

low = mu - 3*sigma
hig = mu + 3*sigma

curve(dnorm(x,mu,sigma),low,hig,col = 2,main = "Función de densidad",xlab = xlabel,ylab = ylabel)
curve(pnorm(x,mu,sigma),low,hig,col = 4,main = "Función de distribución",xlab = xlabel,ylab = ylabel)
```

#### iv) ¿Cuánto valen E(X) y SD(X)?

```{r}
# ESPERANZA
E = mu
paste("E(X) =",E)

# DESVIACION ESTANDAR
SD = sigma
paste("SD(X) =",SD)
```

