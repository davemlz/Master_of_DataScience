---
title: "Práctica 3"
output:
  html_document:
    df_print: paged
---

## David Montero Loaiza

### Problema 1

Estamos esperando un tren que llegaría en los próximos 100 minutos pero desconocemos el momento exacto.

Definimos la variable aleatoria X = "tiempo de espera en minutos". Realiza las siguientes tareas:

#### i) Considera que X es una variable aleatoria uniforme en el intervalo [0; 100]. ¿Cuánto vale E(X) y Var(X)?

```{r}
a = 0
b = 100

# VALOR ESPERADO
E = (b + a)/2
paste("Valor esperado E(X) =",E)

# VARIANZA
V = ((b - a)^2)/12
paste("Varianza Var(X) =",V)
```

#### ii) Simula los tiempos de espera de una muestra aleatoria de personas con tamaño muestral n = 30 y calcula la media muestral X y la varianza muestral S^2.

```{r}
# TAMANO MUESTRAL
n = 30

# TIEMPOS DE ESPERA SIMULADOS
d = runif(n,a,b)

# MEDIA MUESTRAL
X = mean(d)
paste("Media muestral =",X)

# VARIANZA MUESTRAL
V = var(d)/n
paste("Varianza muestral =",V)
```

#### iii) ¿Cuánto valen E(X) y Var(X) para n = 30? Y si aumentaramos a n = 100?

```{r}
# VALOR ESPERADO PARA n = 30 Y n = 100
E = (b + a)/2
paste("Valor esperado para n = 30 y n = 100 E(X) =",E)

# VARIANZA PARA n = 30
v30 = var(runif(30,a,b))/30
paste("Varianza para n = 30 V(X) =",v30)

# VARIANZA PARA n = 100
v100 = var(runif(100,a,b))/100
paste("Varianza para n = 100 V(X) =",v100)
```

#### iv) Simula 500 muestras aleatorias de tamaño n = 30 de la variable X.

```{r}
# MATRIZ DE 500 FILAS POR 30 COLUMNAS
M30 = matrix(runif(30*500,0,100),500,30)
```

#### v) Calcula las 500 medias muestrales.

```{r}
# 500 MEDIAS MUESTRALES
X30 = rowMeans(M30)
```

#### vi) Calcula la media y varianza de las 500 medias muestrales y comparalas con los valores obtenidos en el tercer apartado.

```{r}
# MEDIA DE LAS 500 MEDIAS MUESTRALES
x30 = mean(X30)
paste("Media =",x30)

# VARIANZA DE LAS 500 MEDIAS MUESTRALES
V30 = var(X30)
paste("Varianza =",V30)
```

#### vii) Repite los tres pasos anteriores para 500 muestras aleatorias de tamaño n = 100.

```{r}
# MATRIZ DE 500 FILAS POR 100 COLUMNAS
M100 = matrix(runif(100*500,0,100),500,100)

# MEDIAS MUESTRALES
X100 = rowMeans(M100)

# MEDIA DE LAS 500 MEDIAS MUESTRALES
x100 = mean(X100)
paste("Media =",x100)

# VARIANZA DE LAS 500 MEDIAS MUESTRALES
V100 = var(X100)
paste("Varianza =",V100)
```

#### viii) Representa las 500 medias de tamaño n = 30 y las 500 medias de tamaño n = 100 mediante dos histogramas en una gráfica de dos paneles.

```{r}
# NUMERO DE BINS PARA HISTOGRAMAS
bins = 30

# HISTOGRAMAS
par(mfrow=c(1,2)) 
hist(X30,breaks = bins,freq = FALSE,main = "Histograma para n = 30",xlab = "Tiempo de espera en min")
hist(X100,breaks = bins,freq = FALSE,main = "Histograma para n = 100",xlab = "Tiempo de espera en min")
```

#### ix) Superpón a cada histograma la función densidad normal con mu = E(X) y sigma^2 = Var(X)/n.

```{r}
# HISTOGRAMAS
par(mfrow=c(1,2))

# HISTOGRAMA Y FUNCION DE DENSIDAD NORMAL PARA n = 30
hist(X30,breaks = bins,freq = FALSE,main = "Histograma para n = 30",xlab = "Tiempo de espera en min")
curve(dnorm(x,E,sqrt(v30)),add = TRUE,col = 2)

# HISTOGRAMA Y FUNCION DE DENSIDAD NORMAL PARA n = 100
hist(X100,breaks = bins,freq = FALSE,main = "Histograma para n = 100",xlab = "Tiempo de espera en min")
curve(dnorm(x,E,sqrt(v100)),add = TRUE,col = 4)
```

#### x) Comenta el resultado.

Al realizar 500 muestras aleatorias de tamaño n = 100 la densidad aumenta en el valor esperado E(X) = 50 en relación con las 500 muestras aleatorias de tamaño n = 30. Al disminuir la varianza debido al aumento del tamaño de cada muestra la densidad se concentra más en la media.