---
title: "Ejercicio 8"
output:
  html_document:
    df_print: paged
---

## David Montero Loaiza

### Problema 1

Escribe una función de R que reciba un vector de números x (la muestra), y genere una muestra bootstrap de ese
vector.

```{r}
bootstrap = function(x){
  
  # TAMANO DE X
  N = length(x)
  
  # MUESTRA BOOTSRAP
  b = sample(x,N,replace = TRUE)
  
  # RETORNAR NOOTSTRAP
  return(b)
  
}
```

### Problema 2

Utilizando la función anterior, escribe una función que reciba un vector de números x (la muestra original) y un número natural N, y que genere una matrix que tenga N columnas, siendo cada una una de las muestras de
bootstrap.

```{r}
bootstrapMatrix = function(x,N){
  
  # MATRIZ VACIA
  BM = NULL
  
  for(i in 1:N){
    
    # RELLENAR MATRIZ CON MUESTRAS BOOTSTRAP
    BM = cbind(BM,bootstrap(x))
    
  }
  
  # RETORNAR MATRIZ DE BOOTSTRAP
  return(BM)
  
}
```

### Problema 3

Escribe una función de R que reciba un vector de números x (la muestra) y genere una matriz que contenta TODAS
las muestras jacknife con el mismo formato del ejercicio anterior.

```{r}
jacknife = function(x){
  
  # TAMANO DE X
  N = length(x)
  
  # MATRIZ VACIA
  JM = matrix(rep(x,N),N,N,byrow = FALSE)
  
  # CONVERTIR LA DIAGONAL EN NA
  diag(JM) = NA
  
  # RETORNAR MATRIZ DE JACKNIFE
  return(JM)
  
}
```

### Problema 4

Utilizando las funciones anteriores considera la desviación estándar de la media muestral para una muestra de
N=10000 que se distribuya como en el ejercicio 1 (gaussiana centrada en 1.78m y sigma=0.1). Compara la desviación estándar obtenida, con la obtenida con bootstrap.

```{r}
# PARAMETROS PARA GENERAR UN VECTOR ALEATORIO GAUSSIANO
N = 10000
mu = 1.78
sigma = 0.1

# MUESTRA DE TAMANO N
x = rnorm(N,mu,sigma)

# MEDIA
theta = mean(x)

# BOOTSTRAP MATRIX
BM = bootstrapMatrix(x,1000)

# MEDIAS BOOTSTRAP
thetaB = apply(BM,2,mean)

# DESVIACION ESTANDAR
sdB = sqrt(sum((thetaB - theta)^2)/(length(thetaB) - 1))

# COMPARACION
paste("Desviacion estándar Bootstrap:",sdB*sqrt(N))
paste("Desviacion estándar:",sigma)
```

Las desviación estándar estimada se aproxima en gran medida al parámetro utilizando el método Bootstrap.

### Problema 5

Repite el ejercicio anterior utilizando la técnica jackknife. ¿Cuál da mejor resultado?

```{r}
# PARAMETROS PARA GENERAR UN VECTOR ALEATORIO GAUSSIANO
N = 10000
mu = 1.78
sigma = 0.1

# MUESTRA DE TAMANO N
x = rnorm(N,mu,sigma)

# MEDIA
theta = mean(x)

# JACKNIFE MATRIX
JM = jacknife(x)

# MEDIAS JACKNIFE
thetaJ = apply(JM,2,mean,na.rm = TRUE)

# DESVIACION ESTANDAR
sdJ = sqrt(length(thetaJ)*sum((thetaJ - theta)^2)/(length(thetaJ) - 1))

# COMPARACION
paste("Desviacion estándar Jacknife:",sdJ*sqrt(N))
paste("Desviacion estándar:",sigma)
```

La técnica bootstrap se acerca en mayor medida a la desviación estándar muestral, esto se debe en gran medida a que los valores remuestreados con Jacknife son en práctica los valores originales, quitando uno de la lista en cada caso.